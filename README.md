# VBAPlus

VBAPlus は、VBA の基本的な型の利便性向上を目的として開発され、特に文字列操作における作業を効率化するための機能を提供します。

## clsEnhancedString
`clsEnhancedString` は、VBA での文字列操作を拡張するためのカスタムクラスです。  
このクラスは、以下の機能を提供しています:

- **初期化およびプロパティ**
  - `Initialize`: 初期文字列を設定し、必要に応じてインプレース更新を有効化します。
  - `Value`: 文字列の取得および設定。
  - `Length`: 文字列の長さ（文字数）の取得。

- **変換機能**
  - `ToUpperCase`: 文字列を大文字に変換します。
  - `ToLowerCase`: 文字列を小文字に変換します。

- **トリミング機能**
  - `Trim`: 両端の空白を削除します。
  - `TrimStart`: 左側の空白を削除します。
  - `TrimEnd`: 右側の空白を削除します。

- **抽出・置換機能**
  - `Slice`: 文字列の一部を抽出します。
  - `Splice`: 文字列の一部を置換または削除、挿入します。

- **検索機能**
  - `Includes`: 指定した文字列が含まれているかチェックします。
  - `IndexOf`: 指定した文字列の位置（0ベース）を返します。
  - `StartsWith`: 文字列が指定した文字列で始まるかチェックします。
  - `EndsWith`: 文字列が指定した文字列で終わるかチェックします。

- **置換機能**
  - `Replace`: 最初に見つかった部分文字列を置換します。
  - `ReplaceAll`: 該当するすべての部分文字列を置換します。
  - `ReplaceRegex`: 正規表現に基づいて文字列を置換します。

- **その他の機能**
  - `Split`: 指定した区切り文字で文字列を分割します。
  - `PadStart`: 指定の長さになるよう左側を埋めます。
  - `PadEnd`: 指定の長さになるよう右側を埋めます。
  - `Repeat`: 文字列を指定した回数繰り返します。
  - `Template`: テンプレートとして文字列を適用します。
  - `Reverse`: 文字列を反転させます。
  - `Test`: 正規表現パターンにマッチするかテストします。
  - `Match`: 正規表現パターンに該当する部分を抽出します。
  - **InPlaceUpdate**: 文字列の更新方法に関する機能を提供します。

なお、VBAは本来1ベースのインデックスを持つ言語ですが、  
`clsEnhancedString` は0ベースの思想に従って設計されているため、  
インデックスや位置指定の動作が一般的な0開始となっています。

また、デフォルトでは新規インスタンスを返すオブジェクト指向の設計となっていますが、  
`Initialize` メソッドのオプションとしてインプレース更新（内部変更）を有効にすることで、  
既存インスタンス内で値の更新を行うことも可能です。

---

## clsEnhancedNumber
`clsEnhancedNumber` は、VBA の数値操作を拡張するためのカスタムクラスです。  
このクラスは、VBA の基本的な数値型に対して、より直感的かつ柔軟な四則演算や各種数学的操作を提供します。

- **初期化およびプロパティ**
  - `Initialize`: 初期数値を設定し、必要に応じてインプレース更新（既存インスタンスの更新）を有効化します。
  - `Value`: 内部で保持する数値の取得および設定を行います。  
    ※ 設定時には入力値が数値であるかどうかをチェックします。

- **基本の算術演算**
  - `Add`: 指定された数値を内部の数値に加算します。
  - `Subtract`: 指定された数値を内部の数値から減算します。
  - `Multiply`: 指定された数値と内部の数値を乗算します。
  - `Divide`: 指定された数値で内部の数値を除算します。  
    ※ 0 での除算や非数値が渡された場合はエラーとなります。

- **累乗・平方根・四捨五入**
  - `Pow`: 内部の数値を指定した指数で累乗します。
  - `Sqrt`: 内部の数値の平方根を計算します。  
    ※ 負の値の場合はエラーを発生させます。
  - `Round`: 指定した小数点以下の桁数に四捨五入します。

- **その他の数学的操作**
  - `Abs`: 内部の数値の絶対値を返します。
  - `Floor`: 任意の丸め単位で内部の数値を切り捨てます。（デフォルトは 1）
  - `Ceiling`: 任意の丸め単位で内部の数値を切り上げます。（デフォルトは 1）
  - `Modulo`: 指定された数値での剰余を計算します。

- **三角関数および対数・指数関数**
  - `Sin`: 内部の数値のサイン（正弦）を計算します。
  - `Cos`: 内部の数値のコサイン（余弦）を計算します。
  - `Tan`: 内部の数値のタンジェント（正接）を計算します。
  - `LogE`: 内部の数値の自然対数（底 e）を計算します。  
    ※ 内部の数値が正でない場合はエラーとなります。
  - `Log10`: 内部の数値の常用対数（底 10）を計算します。  
    ※ 内部の数値が正でない場合はエラーとなります。
  - `Exp`: 内部の数値の指数関数（e^x）を計算します。

- **変換およびインプレース更新**
  - `ToString`: 内部の数値を文字列に変換し、`clsEnhancedString` オブジェクトとして返します。
  - **InPlaceUpdate**: `Initialize` メソッドのオプションにより、演算結果を新規インスタンスとして返すか、既存のインスタンスを更新するかを選択できます。

各メソッドは、入力値の検証やエラーチェックを行い、無効な操作（例：ゼロ除算、負の値の平方根など）の場合は明示的なエラーを発生させることで、より堅牢な動作を実現しています。

---

このように、`clsEnhancedNumber` は VBA における数値演算を拡張し、直感的なメソッド呼び出しによる計算処理を可能にするための便利なクラスとして設計されています。
